name: CI
on:
  push:
    branches: [ main ] # 当代码推送到 main 分支时触发
      paths-ignore: # 忽略以下路径的文件变化
        - '**.md' # 忽略所有 .md 文件的变化 (包括子目录)
  pull_request:
    branches: [ main ] # 当有 Pull Request 目标是 main 分支时触发
      paths-ignore: # 忽略以下路径的文件变化
        - '**.md' # 忽略所有 .md 文件的变化 (包括子目录)
jobs:
  build:
    runs-on: ubuntu-latest # 在最新的 Ubuntu 环境下运行
    steps:
    - uses: actions/checkout@v4 # 检出你的仓库代码
    - name: setup xmake
      uses: xmake-io/github-action-setup-xmake@v1
      with:
        # The version to use. Should be a semver range or 'latest'. Or use [{repository}#]branch@{branch_name} to select a branch.
        xmake-version: 'latest'
    - name: Build with Xmake
      run: |
        xmake config
        xmake
    - name: Run Tests with Xmake
      run: |
        xmake run -g threadpool_examples
